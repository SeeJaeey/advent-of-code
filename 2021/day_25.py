import numpy as np
from time import perf_counter

input = """...v.>...v...>.v....v..vv.vvv>v>.v.v>..>v>..>.>.>v.v.>>...>>..v.vv.v.v.v..>>.>>v..v>..>>v.vv>v.>......>v>.v...v>..>...>v>v>>.>.v>>.v>>..v>.
..>.v.vv.>.v.v.....>.>>>.>...v..v...v.>v>vv.v...v...v.>....v...v..vv.>..>..>v.>.>v.v.vv......v>vv.>..vv.v>>.v>v.v....>..v>v.v.>v.v>.v.v>v.>
>..>>v...v.>..v>...v>..>>>v...>>.v>.v..>v.>vv>.>.>v..vv.>.>v..v.>vv>>v..vv..>..vvvv.vv>.........>>..>.>.>.v>..>v.v>...>v...vv..v.>.>.>>.v..
>>.>vv..>v>.....>.>..>vv..v...vv.>>>.>vv.v.>vv...vvvv......v.....>..v....v>...>...>..v>...v.>.v..>>.v>.>..>v>v>....>v....>.....vv..v.vvv...
v>...v>>v>.>.....v...>.>>..>>>v....v..v.vv.vv..>.>..vv.v>v>>.>>vv>..vv>.v>...vv...>..v>....v....v>.>>...v>..>>vv>.>.v>v>......>v....v.v>v.>
..>.vv.v.>..>vv>v..vv>....>v.v..vv..v>...v......vv>..>.>>.>v....v>v.>>.....v.>v.>vvvv>v.v>..>.v.>>...>......v>v.>vv...>v>..vv>v>>..v>>.v>>.
vv..>.>vvv.>v.v>....v..vv.v.>..v.v.>>v.v....>..v>>...v.>..vv.>..v..>>>v>>>...>...>v>.v>vvv...v.....>.>.v.......>..>v..v.>.>..v>v>v.>v....>.
.v>..v..>>..vvv..>.v>.>vvvv.>......v.>v.>.>v>vvvv.>v..v..>..>v...>v.v..>....>>.>v.vv>..v>.vv.v..v.>..>.vvvvv>......vv..vv..v>>v...>v>.>..>.
.v.v..>>>>.v.....v>...v>v.>>..>>.vv....>.v>.vv.v....vv>vv.>>....v..v>v..>.>>..v..v>v...>v>..v..>.......>>.>..vv....>v....>...>>>>v.>>...vv>
>>>>>.vv.......>>...v..v..v>v>>>....v....v..v.>.>....>..v>v.>vv...v>...>..>.....>v.>>.v>>.>.....>..vv.>.v.v>>v....v>.>v>..>>.v>v>>>vv...>>>
..v.>.v...v>.>.>v.v..v>..v.>>v.v.v>v.>vv>.>.v...vv..>...>v>v>>vvv.>vv..v..v>.vv.>.v...>>..v>.>>.....v.vv>v>>.v>v>>v..v..vv.v..>.v.>vvv..>.v
v>..>>v.>....v.v>.>vv..v.>.v.>.v.v..v......>v>vv.>>.v..>..v..>.vv.>vv.v>>......v.v>>.v..v>v.>v..v.>>....>...vv..vvv..vv.>.vv.>>>.......vv.>
v.v>.>..>.v..>>vv......>...>v>v.v.vv..>>>.>..vv>v..>...>.vvvv.v..v..>v>v.>.v.>..v..>...vv.v..v.>>....>.vvvv..vv..v.>.v>.v.vv.>.v....v.vv>.v
...v..>.>v.vv>..>>..>.vv..vvv>.>.>...>.>v>vvv>.>v>>vv>....v>...>>>v.v>>>..v>......>>..v....>v....>.vvv>>v...v..>..vvv....>v.>.vvvv>.vv.>v.>
v..>....v>...>..>..>.>>.>vvv>.v.>vvv.v...v.>v.v>>.>>v.>.v>..v>vv.>.v>.v..>.>..>...v>...v....v.>.....v.>.vv>>.vv>>v...v..v.>vv>..>>.vvv....v
v.vv>.vvv>.v>v>vvv.v>>.>...>v.>v.>.v.>.>..v.>>..>...>.v.vvv..>>>>>.v..v.>..>>......>.>..>v..v.vv..>.v..vv>.>>>.v>vv......>..>.v>v..v....v>>
..v>>...v.v.>>>..v.vv>..>.>.v>..>.>.vvv...v...>>>............vv.v>v>.v.>>v..>v...v........>...>vv...v......>...vv....>>>.v>.vv...>.vvvvv..>
.v>>....>....vv.vvv..>>....v>..v>vv...vv>.>v.v>vv..v>vv>>.vvv..v>..>v..>v...v...v.v...>.v.v.v.v...v.>>>...v...v......>>v..>...vv>.>.>..v...
v.>...v>>...>>.>....v.>vv....v..>v..vv>..>vv.vv.v.v...v......>...>v>v.>.>>vv.>.>.v.v.>>v..>...>.v>v.>.v>v.v.v>.vv.>...v>>...v>v..vv>.v..v..
vvv>>..>>>.v....v.v...>v.>>v..v...v>.vv>v..v...>...>.>v>vv..vv.v>.>v..>>v..v..vv.v>..v.>...v....vvv>.>..v>v>>..>.>v......v...>v..>.v..v.vv.
>vvv..v.>..vv....>..>v..>..>..>>>.>.....>>..vvvv.>.vv.v>v.>.vv...v..>>v.vv..>v..v..>..>..>.v.v...vvv.>..vv..v>......>.v..v.vv>>..>>..>...v.
.v..v>.v...v.>>>v.>.>>>v.vvv..v.v>>..>v........v>.>v>.>....>>....v..>v>.>>>....>v>v..v.>.>.v>>.v.>v.>>v..>>..>>...v.vv>v..v>v>.>>.v>v>>>v.>
v....v.>>>.>>..>vv>>...>v.>....v.v...v..v..>vv.v..v>v>vv..>>>v.v>v>>>vv>.>.>>.>.vv.v>vv....>.>>>>>>vv..v.>vv....v..v.......>vv.v..v...>..vv
v..>.vv.v.v>.....vvv>>.>v>.v.>.>>>>>....vvv..v>.....v>vv.v>.>>......>...>vv>v>v.>>..v.....v.vv..v.>>v>..v>.>>vv.>v.vv...>.>v.v.v.>v..v..>v.
..vv....v..v.>>......>.>v..>>v.>..>.>...v.>v>vv>..>.>vvvv..v.v...v.v>>vv.>..>..>>>v..>>v>.v>.....>.v>v>..>...v.v.v...v.>v>>.vv.>....v....v>
>.v>>.>.>.v.v.....v....>..vv>>vv.v.vvvv>>...v>.>>..v..v>vvvvv.vv.>.v....>.v..vvvv>vvv.vv.v.v.v.>v.>.v.>>v>vv.v..v>.>.....>.>>..>>>vv>.>v>v>
v.v.v>.....vv>>.v..v.>.v>.v>..>.v..>...v....>.>.>v>v..>v.>.v>>.>v....v.....>vv>>>..>..v...v.v>vv>v>.v>...v.>v...>.>>>.v.vv>.>..>>v.v.vv.v>v
v>.vvv..v.v.>...>>...vvv...>v.v..>...v.>>.v>v..v...v...>.vv.v>.>.>>v>....>.v>v>vv.vv..>v..>......vv.>.>..v.v..>.vvv.>vv.>>.vv>.vvv.v>.>>>v.
..v>v..>v.>..v.v.v>v>.v.>v>>>..>.>..>v>>v...>>v.vv..v>.>>...>v..>.>v.>..v.>>.v.>>vvvv..v>>..v>.>........>>>v.>..>v..vvv.vv..>v>>>v..>v>...v
........>v.>......vv..>..v.....v..>v..v>.v>>.>>vv..>...>vv>......vv>.....v>..v...>v>v.v.>vv.vv.>......>.v.>.>>...>...>..>>>>.>vvv....>v..v.
v...>v>..>v..v.....v.v>>v>>.>v.>>>v.v>>>v>...>.....vv.>>...>.v.v.vvv>>>v.v.>.v>.>.vv>...>.vv>..v..v>..>v>.vv.vv>..>.>.>..vv....v.>....>.vv.
v>>.v...v.>..>>...v.v.v.vv>..v>.v.v>.v..>>>.vvv.v.>.v.>v.v....v>>v>v.>vv.....>vvv..>>v>v>>..vvv.>.>....v...>>.>..>.v...vv..v>.>>..v.vv>>...
>v...vv>....v>>..vvv..vv..>>>>.>>>v........v.v.v.v..v.v..>>>.>.vv>v.>..vv>.>>.>.>vv.>..>>>>.>..v>.>.v...>..v>>..v>..>..vv>.>..>v.v>>.v.>.>.
.v..v>.v>.>>v>..v...>v.v.v.>.v.>..v.>.v>>>....vv>>.>...>.>>v.v>...>....v...vv>.vv.vv.v.......>..>>vv>>>>....v>>.>v>.v>v>v>v..v>vv>....>....
>vv>v..>...vv>....v.>.vvv.v.v.>..>..>..>..>>vvv..>v.v>v>..v>>.v>>.v..>v..vv>.v...vv..>v.v...v...>.v.v>.>v>>>vv>v..vvv>.>v...>>>.>..>......>
....v>......>>>.>.v.>.>v...>v>......v..>>>.>.v.>vv>v.vvv>>.>...vv.vv.v.v..>>.vv..v>..>>vvv>.>....vv>..v>.vv>v.v..>vv.v..v.........v....>v>.
>...>vv>v..>>.v>.v...v.>.>.v>.....>>>vv>v.>.>>.v..>.>>v..>>>............v.v.>.>..>v..>.>v..>>v>v>v......v>.v...>v>.>....>.>..vv..v..>v>....
..v..>......>v>v..>>.>..v...v>>vv...>v...>>>..v.v..>>v..>.>>.v.>vvvv>v>>v.>>..>v.vv.v>.>.vv.vv.v.>..>>....>v....>>v>v>.vv>..>.v.>..>.v.>>..
v...>v>.vv..>.vv.v.>v..v.v.>>vv..vv.v..v..vv.>.v.v.>...>>>...vv..>.v>..>>..>>>v.>vvv..v...vvv..>.v>.>>..>v.....v>.v..>v.>.>v.>...>..>...vvv
.v.>.>.......>.v..>.v>vv>>v.>v...v.>>v.....>.>>.v>>...>v>.>vv.vv..>..>>v.>....v.....>>vvv.>....>.>.>v.v>.>.>.>v>....v.....v.>...>..v>v>.v>v
vvv...>....v.>v>.>v.v.vv...v>..>..>>>v>.>..v..v>..v.v..>>.>.>>.v.v..v....vv>...........vv...v...>>...>.>...vvv..>v>>>v...vv.>.v>..>...v>vv.
..v.>v....v>>.vv.v..>.v.v..v>..v.v.v....v.v.>....v>v..v..vv.>>>......v.>>...v>..v.vv.v.v.v>v.>>.>>.>>vv>.vv>v.>..v.v.vv...v.>>v.vv.>.v.v.>v
v.....vvv.vv>>...>v..vvvv..>....>>..v.v>>vvv>.v..>>v...v.v.vvv>.>..v.>vv...v.......v.vvvv..>.v>>.>.>.>>>.>..v....>>.>v..>...>>>v..>.>vv..v.
>v.>>.v.v>>.v.v>...v>..v......>v.>.v..>v.v>..>v.vv..v>v>v.>..>v>vv....v.vv>..>v>v.vv.....v.>.v>>vvv..vv>.v..>>>>>v.v>v...>..>.>>v..>>v...v.
...>.>.>..v>.v.v>vv.v.....v.v..v>>.>>>v...v....v>v>v>>..v>..>>vv>.vvv.v>vv.v.v..v.vv.vvv>>.>v.>>.>>.>v.v...>v...v>.>>.>..vv>v.>v>.v>vv.>.>>
..>.v.v.vv.v.>v>....v>>>vv.vvv.>vv>.v.v>..v>...>..v>..>...v.>.v.v.v..v.>v>>...>>...>.>>v>..>>v>>.v.vv>>..v.v.vvv.v...>..>>>>....>vv.>..v..v
>v.>v..v.>>.>v.>....vv.v..>v>.vv>vvv>..>...>.v.>....>.>>....v.>>>..>.>.>.v.>..vv>vv>..v..>...>v>.>>v.>.>>.>...vv>.v.vv>v.vv....v...>......>
..>v>.>.>.>>v>v.v......v.>vv.>>..v.v.vv.>.>vv..v..v.....v>.v.>vv>vvv.vvv>>>.>vv.v>>v.>v...v>>v>.v>>..>>.v>.>.>>.>>>vv>>.v>>>..>.v>....v..>.
..>.v...vv.....vv>>vvv>....>vvv..v.v.vv>vv..>vvv.v...>.v>>>.....v>..>..>vv...>>.>>.vv>.v.>>.v>.>>...v.v..>.v..vvv....>>v...>v.v..>.v>v.>v..
.>...>..vvv.v....>..>v.v..>>..>.>.>.>.v.>>.vv.v>v..>.>v>vvv>...v....vvv..v>>..v>>.>>..>.>..v>>v>>.vv...v>.>>.>>..v.v.>.v.>v..v.>>vv.v.>..v>
vv>v..>v......v.v..>vv.>>.>..vvvv.v.v..>..>.vv..>..>vv...>v..v.v.>v.vvv>>.....v>>.>...vv.>>>v..>v.vv..>>v..v.vv.>>vvv......v.>.>>..>..>...v
..>...v.>.v>>..v>v>......>..>v.>>.>>.v.v...v..vvv.>......vv>v>.v....v..v.v..vvvv...>>>...>.....vv....>>.v>.v...v>.v.>.>vv.v..v>.>>v>>.>>..v
v>.v.v.>>....>>.>>.>.>.>>.vv...>.>>vvv.v>>....>.>..v>...>.>>.....>.>v.vv.vv>v>..vv.>>.....v....>v..v..>..>v.v.>....vv...>.vvv.v.>v....vv...
...v..>....v..v..v.v....>.>.v..>>..v.v..vv..>>.>...v>>..>.vv...>...>....>.v...v>v...>...v.>>.>v.>.>.>.vv..>.>vv.>.v..v.>>>v>>>v..v.v...v>..
.>..>>v>..>>.v.v.>v...v....v>vv..v>.>>>.v..v...v.>..>...>.>v>v.>>.>..>>v..>.vvv.v.v.v>..>>.>v.>v...vv.>>v>v...>>.>.....>.>v..>.>.>v>>..vvv.
.v>vv.>v...>>.>>..v.>>.>>..v>...v>.v>>...>>.v.v.>..v.>.>v.>.vv>.v>v...v>v..vv>v...>.>>v>>.>...>v>>.v.>v.vv......>.v>v..>>..v.v>>..v>>.>..v>
.>..v...>v.>>v..>>>...>.>...v>v>v>>v>.v..>v.....>vv>.v.>.>>....v..>v.v....v>v..>.....v..>.v.vvv.....>.v>vvv>..v.......>...v.>>>..>....>>..>
>>.v>v...>v..>>v.v>.>..vvv>..>..v.>>v>..v>....>.vv..>.>.v..vv>.>....>>v.vv.>>>v...>...>v....v>>vv>.v>..>v.v...>vv.>..>.vv.....v>v.>.v..>vv>
.>..vv>.>v>v.>>.v>>.v..>>.v.v.v.vv>..>.v>>...v.vvv>...>>vv.>v.v>.>.v>v.vv>..>.v...v>>>.vv.v>..v.>>..vvv...vv.>>.vv.>>v>.v.v.v.>..v>.>v>..>.
..v.....v>>v.>...>..vvv..>vv.>.....vv>>>.>vv..>..>.>..vvv.>.>>>>>>>v>..>.>>>.....>v..>>v.>.>.>.vv>..v>.v.>v>.>...>..v.>..>.>>...v.>v>...>>v
..v.>...>>>>.>>.vv.....>>....v>>.>.>.vv.v>v.v....v.>....>v>.v..>>.v.v.v.>v.>vv.>..v..v.vv..v....>>>.......v.v.>....vv>vvv>.>.>>>...>..v>..>
.......v>v>..>vvv.v..vv..v.>.....>>....v>...>v..v..v..v>...v>..v>v>>vv.v>.>>>..v.>>>>vv>v>..v.vv...>.v..>...>..v.>v...>..>.v>vv.>>.....>v>.
vvvv>>v.v.v..v..vv..>.vv>v.>>.v>v..v>.>..vv>..>>..v...>v...>...v>...>..v>...vv..>.>>>.v.v>v..>..v.vv..v..v.v...vv>>...>>>>.>v>v.v.vvv>>.vvv
..v.>v...>.>v>..>.v.>>v>v>......v.v>>v.v.v.>...v..>v>>v..vvv..>...>..v.v..v>v>vv.v>...>v..v.v>.>>>>..vv.v>>.v.v..>>>>v..>.>...>vv>.v.v>.>..
v>v.>>.........v..v...v>vv>.v.v.v.v.....>...>..v..>v.>.v.>>>v.v>.v..vvv.>v.v..>...>>>>>..>.>vv..>..>>>..>v.>...>.v.v.......>.>vvv.>>v..v>..
>..>>.v.v...v>>....v..vv.>v.v>vv>vv>.>>.>.v...>.v......>>.v...vvvv.>>v..>v..vvv.v.....v..>>..v>>.v.>>>vv....v>>>>.>.v.v..v>>v.v.v.>vvvv....
v..>...>>>.v..vv.v............>.v.>>v>.>..v.>v...v...v.v...v.v.vv.>.>v.v..>..v..v.v>.v..>.>.>>v...v>..v..v...>..>>...v>>v....v...v.v..>vvv.
.>>v..v.vv>..>>..>>>....>.>....v>>.v>.>..v>.>.>.vv...vvv>.......vv......v..v>>...>.>>..v..>>vv..>v.v>.>..>..>>...>.v.>>.>v.>..>.v.v>v.....>
vv>.>vv>.>>.>..>......>>v>v....vv.v.>vv.v.v...v.v.>>.vv.v>.>>>..vv.>..>>vv.vv.....>>>>vv>...v.>.v>.v.>.>vv.v.v.>v..v>.>>...>v.vvvv>.>>>>...
>....v>.....vv..v>vv.....v.v>....vvvv..>.>>.vv..vv.>.v>>.v>v.>.v.v>..v.vvv.>>.>.>..>vv..vvvv......vv>vvv.vvv.v..v....>.>vvvv>>v>v.>vv..v.>v
>>>.v>.>..v>.>.>..vv>>>....vvv>...>vv.>.>.vv.v....>....>.v.....v.>.>.>...v..vv..>......>>>>vvv.....>.vvv..>.vvv>.>>....v..>......>v.....v.>
...>>..>>.....v.>>.v.>.>>vv>..vv.v.>v>>v..>>>..>vv.v>v>>v.v.vv>.v>.v.v.>.>.>..>.>>>......>>.v....>v.......v..v>.....v>v..>>v.>..>..>v..v>..
v>>>.v.>.v.....v..>>...>.>>..v...>.>v>..>....>.vv.>>.vv.v..vv>.>.v>...v......>>>v>>>...>>..>v.v..v..>>.vv.>...v...>.v.v.vv>vv.v>v.....>..v>
.>.>>.....v.v...v..v>...v...vv.v.>.vv...>>>>v.vv.>.vv..v....v.>.v>v..v>>....>>>v..v>.>.v>..>.vvv>.v>.v>>v.v>>...vv.>>>v.v....>>.v.vv.vv.v>.
..v..v>>vv>.v>..>>....v>>>.>.v>v.vv..>>vv>...>>..>.vv>v.vv>...>.v>>v.>.v...v.v.....>..v.>>.v>.>...v..v.v....v.vvvv.vvvv>..vvv.v.>v..v>>>>>.
v.v.>.v.>.v>v...>.vv.>.>...vv..>...>.v..>.....v..>>v>v.v.v..v>>....v..vvvv.>..v>.>.v.>.vv..>v>>v>.>....>v.......>>...>>..v...>...vvv....>..
vv.>.v>.vv.v>>>v>..>>..v.v>..>>>>...>.>vv.>...v>>.>..v....>vv..vv.v.>.v.>vv>.v>.......>.>>.v..>vvv..v>.>>.>>..v>.v>>.v>...v.>v...vvvv.>v.v>
>..v>>.>v...v.......v...v..>>v.>....>.>>..>v.v>.....>>>.>.v>>vv.....>vv..v..vvv>...vv....v>...>>>.v>>vvv.>>..v...v..>>>....>.>..vvv.vvv.>.>
>v>.v>.....v...v.v.v...>...vv>...vv.v>.v>>vv>..v.>>>v.>vv>...v....>....>v...vv.>.vvvvv....v.....v.>v.v.>>>.>>..>..v>>>...v.v..>.vv.>v>.v>.v
.>>.....>...v.>...v...v..v.v.>vv..>v...v.>...>...v...v....>v>>..v>>>.v.v>...>>.>v.v..>>..>...>.v.>....>>...v.......v.v>>>.....v.>.v...v>v.>
v.....v...vvv..vv>>>...>.v.v>>..>v>>>>.v.....v.v>.>>..>.v>.>vv.v>>......v.>v.>>.vv...v.....v..v.v..>.v>v...v.>.>v.>>.vv>...v.v..>>v.....>>v
.>vv>v.vv..>>>.>.vv.vv.>.........>.vv...>.v..>.>>.>>..>....>>>...>..>.>v.v.....>v.>>>v>v..v>.>...v....v>.>..>v>>>>>>>vv.v>>v..>..>>>>>v..vv
..>>...vv..>.v.v.....>.v.v.v>>...vv.....v...vvv...>v>v.v.v...>.>>vv.>.>......vv..vv.>....v.>>v>>v...>v>v>v.>.>.v...>....v>>v>.vv>v>....>.v>
v>.v.v.v.>>.>v>>.vv.>v>vv..v..v.>v.>>..>v>.v..>....v>.>..>..>v>.>v>.v.......>>v...vv.>>>...>v...v>>vv.v..vv...>.....v>..>>...v...v.>v>.>>>>
..v...v.>...>>v...v.>>..vv>v.>.v>....vvvvv>....v>v.v.>v.>>>....v.>...>...v...vv...v..>.vv.>.>>>>>.>>.vv.v.......v.v..v.vvv>..>v.>>v>..vv>..
v.>>>v.>>..>>v.v.v>...>.>vv>.vv....v......v..vv..v.v.v...>.>>v...>>v.>vv>..>.v.>.v.>v.>>>>.vvv>..>.>.>>>>v>.v..vv.>>>>..>.>>>.>.>vv.vv>....
>....vv.v...vv>.v>>.vvv.v>..v>...>...>.....>..v..>v.>.>>v>.>>....>>>v.>>v.>.....>v>v>...>.>.vv.>v>v...>vv...>v....v..>>v..v...>v>>.>v.>v.>.
v>>.v>.v.v>..>.vv.vv>...>v....v>...v..>....v>..v.v.>..>.>.>.v>...v..>....>....v>vv..v>>..vv.v>v....v.vvv.v...v>...>.v.>.....>.....vv.v.....
.....vv>v..>>......>vv.>.>.>v>vvv>.vv..>>vv.v....v>.v>...>..>>.>>>v.>>.>..v.>...>vv>>...vv.>>>....v..v..vv.>.>.>.>...vvv>..>>>v.v...>v.v...
.>.v.>.v>>...vvv....v.v.v.vv>>>>.>.v...vv...>v..>.vv>>.vv>....v.vv.v.v..>>>vv>>>.>>.>v......>>...v...v.v....v....>.v.>..v.v..vv.>.vv..v>>..
...>v>v>..>.v.v..>.vvv.>v....>v.>v.>..v>.>.>>>>>v.vv..>>.v>v.>v.>vv..>>>.....vv>...v..>....v..v...>>vv..>>v>.v.>.vv..>.v..vvv..>.>........>
>.vv.vv.v..>v>..>.>.>.v.v.>.>v.>......v.>>v>...>v.>.v.>..>..vv.......v>..>v>..vv>>v>.....>.>vvvvv.....>.>>....>v.....v..v..v.>>.vvv.v>.v..v
vv>>..>..v..v.>v.>>..v.>>v..vv>v.>...>.>>.vv>.v.>v>.>>...>vv.vv.>.>..v...>vv>vv>>v>..v>vvv>>>.>....>.>..vv....>..v.>v.>.v..>v...>vv>v.v>.>>
>....vv>>.v.v.v.>vv..v.>>v...v.v..>v.>>v.v.v>.>>vv....>>..>.v..>.>.v..>....>>...v.v>>>v.>>>.>>...>v....>v..v..>>>>..v..>v>v.>>vv...>v>.>.>.
>.v>......>.>>....v>>v........>....>....vvvvv>v.v>.vv>>.vv>...vv>..v..>..v.....v....>.v>vv.>.v...v...v...>...>v.v........vv>.v.v.v..v...v.v
v.v>.>v>v.>>.....v>.v>..v...>>>>>v>>.vvvv.v>..>>>>>...>>.>....>>v.>>.>v>...vv.v>.v..>v.>....>vv>>vvvvv.>v.>..>>..>>...>..vv>...>..>v...v.v.
...>.>..>.v..>.>>.>.v>.v>.v.v>>>>vvvvv.>.>>v....v........>........>v..>.>v>...v..>.v.>.>.>..>...v....>..>.>.v>v>..v.>......>..>>>...>..v>vv
..v>vv..>.>.......>.vvv>v..v>>.>.v>>vv.>v>>.v..>v.>.>>v.v.v>vvv....v..v>.>>..>>.v..vv.....>.vv...>v.v....v...>>v....v.vvv.v...v>....>..v...
v..>>>.>>>.vv>v>>>..v.vv.....v.v>>v.v...>...v.v.vv......vv.>>.v..............>..>....>>..vv...>.v.>..>>>...>>vv.v....v..>.>.v.v...>..>.v...
...v.>>..v>.>.>.v>..>vv>.>.>...>..>>>>>..>v.>.v.vv>.v.........>...>..>v.......v.v..v.v>v>>>>v.v.>...>>>...>.>.vvv.vv..>>.vv..>.vv..>>>....v
.v.>..vv..vvvvv.vv...>v.vv.....>.v>>..>>vv.>.>....>v...>...>vvvv...v.>.>>...v.>>v.>v>>.>.vv>>vvv>.>...>>..>..v...v>..v.>..vvv>>.>>.v.v.v>>>
..>.......>.v.v..v>vv>>>.>>..v.v>...>vv.....>>......>..v.vv.v.v.>>..v...>.v.v...>.v>>v...>..>v>>.vv>>>v>v.v....vvv.v....v.>v>>.>....v>>>..v
...>...>.>.>v..>v>......vv>vv>.>...v...vv.....>>>>>...vv>vv..v>.vv>vv...>...vv..>.>..v>vv...>..v..v.>.v..v........v>.>>......>.v.>.v.......
..v>.....>>.v..vv..v......>..>...>v>....v..v.>>..>v..>.>.v>.>>..v..>>>>>.v>>>.v.>>..>....v.....>.>v>.vv>>v>.v.v.>>.vv..v..v..v..>.>>>.>>vv.
.>>.>>.>...v>v..>v.>..vv>>.>.v.>>>.v>>v.>>v.>>>..v...v>..>..>>>vv>>.v..>v....v.>>.v.v.....v>...v>.>......v>...v..>>....v..>>v.v....v..v>>>.
...v..>.>..>..v>>>v.>v.vv..v..vv..v.....v.>>v>v..v.v.>..v>v>>.....>....vvv..>..v.>...>...>>>v.>.v..v>.>>.>.v>>..>..v>v>..v.vv.>>v>.>..vvv.v
v>.v..v..>>v>v.vv>...vv>..v>.>.vv..>..>vv>>>>.v>....vv>.>.vv....>vv...>>.v.v.vv......v.....v.vvvv.....>..v..v.>>v.>.....v>v.>v>...v>.>.v.v.
..v..vv.>.v.v..>>>v..vv>v..vvv..v.vv..v..>..>v.>>.v..>.>...vv>..vv..v.....vvv..>>..v>v..v.>....>vv.>.v>..v....>.>v..v.v..>.>.v...>>.>.>....
.>>.>v..vv.>v...>>v..>...>>......vv...>.v>.v>...v....vv..vv.>>>.v>>..v>v..v.v.>>.>>.>...>..>......>>v..v.>..>...>vvvv.v.v...>v.>v>>...>>v>.
v.>v..v>...>v>..>.>...>v.v>...>>.vv.....v...>v.vv...>>.>.>..>>>.....v>vv..>.>v.>..>...v>..>.v>>...>.>..v.v.v...vvvv..>..v....>..v..v.v>>>>.
v>vv.v...v.v.....vv>.v..>>v.....>...v..v.>>>v.....>v>.>>..v>v.vv.>v..>v...vv.>v.>..v>....v.>>vv>..v.>>>v>.>>>>>.>vv>vv>>>>>.>>.>v.>v.>v..>.
.>.>>>.>.>v..>v.v.vv>.v.v>v........>>v>>>..vvv.>...v...>.>..>.>.vv..vvv...v>.v.>vv>v>.v>.....>.>v......>>...vv>v>.>>..v.>..v.>vv..>>..v.vvv
.v.v......v..v..v.....v.>....v.v>v.v>>.v.v>.v..v.v>vv...>>.v..>v.>.v..vv..>...vv..>>.v.v>.>...v>.....>v>>........v...>>.......>.v..>.>>..v>
>vv.>v>....>..v..>>v>v.>>v....v>>.>v>.>.>.>v.>..v>>..>v..v>>>v...>vv..vv>v..>v..>>.>....v.>.vv..>.v....>..v..>.v...v.>>vvv>v.>.vvv.>>.v.vvv
v...>vv>v.vv>.vv.>>>.vv.v.>v>.v...v.>>>.>.v.>...v.>.v...vvvvvvvvv>>vvv.v.>.v.v.vv.....v>.vv>..>>>v.>.>.vv.v...>v..v.>...vv...v..v...>.vv..>
..v>.v>v>v.v..>>...v.>>.v.v.vvv.v.v>....v.>>...>>...>...v..>>>>>>>v...>....v.v.......>>.>v.vv.>..v>vvv>v.>>v>.>.>..v>..v.>..>...v.v>v>...vv
vv>>.v...vvv..>.v>>v.v...v.v>.>.>.>..>.vv.v.>.v..v.v...v.v.v.>...v.>.>.>>>v.v>....>.>.>...>.>..>v.v>.v>>>..>.....vv>.>.v.>...>v>vvv.>v....v
...>..>...v>.>....vv..v.v.>.v>.v.vv.>v......>>vv.v..v.>..v.>>v...>.>>.>v>v...>.>vv>..v..>v>>.>....v...vvv..>.>v>vv...>.v>...>v.>.v..v>..v..
.>...>>.v>>vv.>v>..>>>v.v>v..v..>....>...v>vv......vv.v..vv>>>..v.v.>>v..>>>v.v.v....>..v>..>v.v..>v......>.>v..v>.v.>v.>v.v>.vv>v>.>.vv...
..v>.>>v..>>..v>>v..vv.v.v.>.>.>.....v...v...>....v.v....>>v>.v.vv.>>.v.>.v.v...v.>v.v>vv...>v>>...v....vv>>>..>..v>>...>>vv>....v..v>..v.v
>vv.>.v>..>v.>.....>v...v>...>.>..v>.v>...>vv>v>...v.v...v.>vvv...>.v..v.>.v.vv.>.v.........>v>.>v.v...>>.>v....v>.v.>...>v>.>....v..v.v..>
....>vv.>.v..v>v.v...>v.v...>...>.>.>....>..v...v...>>>.>.vv.>vvvvvv..>>..v.>v.>vvv..v..vv>..vv>..v.v>...>v.vvv.v.v.>.v.>>.>vv>v>..>.v..v>.
...>v>......>>....>>.>v.....vv.>>..>>.>v.v..vv.vv.>....>vv>...>vvvv>.v>..v.v>..>..>.>v.>v..v>..>.>.>>.>>.v..v..v..>....>..>>v.>.>..v...>>..
>...v.v..>......>...vv>.....>>>v.......>vvv..>.>..vv>>vv....v..vvv....>>>>v>.>.v>>....v>>>vv>...>v.>...>.>..>v..vv..v..>>.vvvv>>..>>.>.>vv>
.v..v>.>....v.>>......vv..v....v..>>..v>v.v>>...v.>..>>v...>v>..>.vv.>>...>>v....>v..v...v.>v.v.>v.v.>v..>..v.v>..>>>>.>v.>v..>>......v.vv.
>>.>.>>.vvv.>.v.>..>..v>v>v>>.>..v.vv.>.>..>v>.>v.vv....>v..>.>.>.v>..vv...>v...v...>>>....>vvv.>...vvv..>..v>>.v...>>.vv.vvv.v.vv...vv.v..
.vv>..>.>...>v.v...>>v...v>v>>.v>>v.>...v>v.vv>.vv>v>v.>v..>.>.>>v..>..v>.>>v>>..v...>>..v...v....vv.vv...vv.>>v..v>.....>>.>>...v>.....>vv
v.>.>...v..v>..v...>.vv.>..>.>.>........>v.>>.....v>...v.>v>vvvvvv.v.v..v>v>....>......>>..>vv>>>>v..vv>.v.v>..v.>.v>>.>..v>v...vv>>v.>v..>
.>.>v.....v.>..>v.>..>.v....v>v>.>..v...v.vv.vv..>.>>v...>vvv>vv..>..vvv.>vv>...v>.v.v..>v..>.v>.v>.>v..v.>.>..>...>>..vv..>>...v>v.>v..v.v
.>>.>..>v.v.>>vv>..>>....>>..vv..v.v..vv>v.v..>v>.....>v.v....v.vvv.v.v.>.v.....vvv>vv.>..>.....v>v>.vv.>v>>.v>v>.>..>.v>v..v......>.v.>.>.
...v>v...>>...vvv>>>....>>vvvv>...>v>>.>v..v>.vvv>>.v>...vv>.v>.>..v>v.>v>>v>v.v...>>v>.....>>..v>..vv.v.>.>>..>..v.vv.>>..>.vv>v.v...v...v
vv>>>..vvv.>.>v>v>v>>v>.>vv..>v>.v.v.v.>>>>...v>...v..v.......vv>..>.v>.>.....>vv..>.>...v.vvv....>.v.>>>>vv>>v>v.>.v.v..v.v.>>v.v>....>vv.
.vvv>.>.....>v>>..>>>v>.>v...v..>v..v.vv>.v.v.>.>v...v..>v..vvv..vv.>.>vv...>...>...v...vv.vv..vv>>>.vv.v.>......v.v......>...>..>v.>v...>.
>.>.v.>>>..>>.v..>v.>.>v.>..v.>v.....v..v>.......>>.>..>..v>.>>...>v...vvv..v>vvv>.v>..v..>...>..>v>...v.v...v.v.>...>.....v..>.v.v>v>vv.>.
v>>v>v.>...>..>....>.>vvv...>.......>>.v.vv.v...>.>.v...>v...>.>..v..v.v....v.v..v>>>>v...>>.v.vv>>>>.v>.>v...>>...>.v...vv.......vv...>>..
....>>...v>.>v.v>>>v.v...........v.v>.>v.v>v..v>v..v.vv>>...v..>>vv...>.v.....v......>....>.v>v.v..vvv>..>vv.>>v...>>>..>...v.>v...>.>.....
>vv>vv.>v.vv.vv.....vv>>.v.v.v..>v>.>.>>vv>>..>.v....v>v>.>..>v>.v>v>.v.>v..>>.v>.>v.>>.>....v>..>vv>..>>>>v>>>.v>...>.vv.v>>>.>vvv..>..vv."""

example = """v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>"""

def parse_input(input_str):
    lines = input_str.splitlines()
    w = len(lines[0])
    h = len(lines)
    grid = np.zeros((h, w), str)
    for i, line in enumerate(lines):
        for j, char in enumerate(line):
            grid[i][j] = char
    return grid, w, h

def move_right(grid, w, h):
    grid_copy = grid.copy()
    for y, row in enumerate(grid):
        for x, char in enumerate(row):
            if char == '>':
                if x + 1 == w:
                    if grid[y][0] == '.':
                        grid_copy[y][x] = '.'
                        grid_copy[y][0] = '>'
                else:
                    if grid[y][x + 1] == '.':
                        grid_copy[y][x] = '.'
                        grid_copy[y][x + 1] = '>'
    equal = grid == grid_copy
    return equal.all(), grid_copy

def move_down(grid, w, h):
    grid_copy = grid.copy()
    for y, row in enumerate(grid):
        for x, char in enumerate(row):
            if char == 'v':
                if y + 1 == h:
                    if grid[0][x] == '.':
                        grid_copy[y][x] = '.'
                        grid_copy[0][x] = 'v'
                else:
                    if grid[y + 1][x] == '.':
                        grid_copy[y][x] = '.'
                        grid_copy[y + 1][x] = 'v'
    equal = grid == grid_copy
    return equal.all(), grid_copy

def task1(input_str):
    grid, w, h = parse_input(input_str)
    step = 0
    while(True):
        step += 1
        equal1, grid = move_right(grid, w, h)
        equal2, grid = move_down(grid, w, h)
        if equal1 and equal2:
            break
    return step

start = perf_counter()
result1 = task1(input)
stop = perf_counter()
elapsed1 = stop - start

print(f"Task 1: {result1}")
print(f"Execution time: {elapsed1}s")